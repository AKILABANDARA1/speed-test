<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>📡 Choreo Ingress/Egress Speed Monitor</title>
    <script>
        async function fetchLogs() {
            const res = await fetch("/logs");
            const data = await res.json();
            const resultDiv = document.getElementById("results");
            resultDiv.innerHTML = "";

            if (data.length === 0) {
                resultDiv.innerHTML = "<p>No logs yet.</p>";
                return;
            }

            data.forEach(entry => {
                const div = document.createElement("div");
                if (entry.error) {
                    div.innerHTML = `<strong>${entry.timestamp}</strong> ❌ Error: ${entry.error}`;
                } else {
                    div.innerHTML = `<strong>${entry.timestamp}</strong> 📥 Download: ${entry.download_mbps} Mbps | 📤 Upload: ${entry.upload_mbps} Mbps | 🏓 Ping: ${entry.ping_ms} ms`;
                }
                resultDiv.appendChild(div);
            });
        }

        async function clearLogs() {
            await fetch("/clear", { method: "POST" });
            fetchLogs();
        }

        setInterval(fetchLogs, 5000);
        window.onload = fetchLogs;
    </script>
</head>
<body>
    <h1>📡 Choreo Ingress/Egress Speed Monitor</h1>
    <button onclick="clearLogs()">🧹 Clear Logs</button>
    <div id="results" style="margin-top:20px; font-family: monospace;"></div>
</body>
</html>
